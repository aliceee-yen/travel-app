<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 è·¨åœ‹è¦ªå­å¤§å†’éšª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-paper: #fffdf5; --ink: #2c2c2c; --kr-blue: #3b82f6; --jp-red: #ef4444; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-paper); color: var(--ink); -webkit-tap-highlight-color: transparent; padding-bottom: 110px; }
        .font-header { font-family: 'ZCOOL KuaiLe', cursive; }
        
        /* æ‰‹ç¹ªé¢¨æ ¼å…ƒä»¶ */
        .sketch-box { 
            background: white; 
            border: 2px solid var(--ink); 
            border-radius: 8px;
            box-shadow: 3px 3px 0px rgba(0,0,0,0.15);
            transition: all 0.1s;
        }
        .sketch-box:active { transform: translate(1px, 1px); box-shadow: 1px 1px 0px rgba(0,0,0,0.15); }
        
        /* æ¨™ç±¤ */
        .tag-kr { background: #eff6ff; color: #1e40af; border: 1px solid #bfdbfe; }
        .tag-jp { background: #fef2f2; color: #991b1b; border: 1px solid #fecaca; }

        /* å¤©æ°£å‹•ç•« */
        .weather-loading { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* éš±è—å·è»¸ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Modal */
        .modal-overlay { background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); }
    </style>
</head>
<body>

    <header class="bg-white border-b-2 border-gray-800 pt-12 pb-4 px-4 sticky top-0 z-40 shadow-sm flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-header tracking-wider">ğŸ¦• è·¨åœ‹å†’éšª</h1>
            <div class="text-xs text-gray-500 font-bold mt-1">2026.02.13 <i class="fa-solid fa-arrow-right text-xs"></i> 02.21</div>
        </div>
        <button onclick="resetData()" class="text-xs text-gray-300 border border-gray-200 px-2 py-1 rounded hover:text-red-500">é‡ç½®</button>
    </header>

    <main class="p-4 max-w-lg mx-auto">
        
        <section id="plan" class="tab-content block">
            <div class="flex overflow-x-auto gap-2 pb-2 mb-4 no-scrollbar" id="dayNav"></div>

            <div id="weatherBoard" class="mb-4 bg-gradient-to-r from-blue-50 to-orange-50 p-3 rounded-lg border border-gray-200 flex justify-between items-center hidden">
                <div class="flex items-center gap-3">
                    <div id="w-icon" class="text-3xl">â›…</div>
                    <div>
                        <div id="w-city" class="text-xs font-bold text-gray-500 uppercase tracking-wide">LOCATION</div>
                        <div class="flex items-baseline gap-1">
                            <span id="w-temp" class="text-2xl font-black text-gray-800">--</span>
                            <span class="text-sm">Â°C</span>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div id="w-desc" class="text-xs font-bold text-blue-600 bg-white px-2 py-1 rounded shadow-sm">æ­£åœ¨å–å¾—å¤©æ°£...</div>
                </div>
            </div>

            <div id="dailyContainer" class="space-y-4"></div>
            
            <button onclick="openEditModal()" class="w-full mt-6 py-3 border-2 border-dashed border-gray-300 text-gray-400 rounded-lg font-bold hover:border-gray-800 hover:text-gray-800 transition-colors">
                <i class="fa-solid fa-plus"></i> æ–°å¢è¡Œç¨‹
            </button>
        </section>

        <section id="translate" class="tab-content hidden">
            <h2 class="font-header text-xl mb-4 pl-1 border-l-4 border-yellow-400">ğŸ—£ï¸ ç”Ÿå­˜èªéŸ³åŒ…</h2>
            
            <div class="flex gap-2 mb-4">
                <button onclick="renderPhrases('KR')" id="btn-lang-kr" class="flex-1 py-2 rounded-lg font-bold border-2 border-gray-800 bg-blue-50 text-blue-800">ğŸ‡°ğŸ‡· éŸ“èª</button>
                <button onclick="renderPhrases('JP')" id="btn-lang-jp" class="flex-1 py-2 rounded-lg font-bold border-2 border-gray-200 text-gray-400">ğŸ‡¯ğŸ‡µ æ—¥èª</button>
            </div>

            <div id="phraseList" class="space-y-3"></div>
        </section>

        <section id="wallet" class="tab-content hidden">
            <h2 class="font-header text-xl mb-4 pl-1 border-l-4 border-green-500">ğŸ’° è¨˜å¸³èˆ‡åŒ¯ç‡</h2>
            
            <div class="sketch-box p-4 mb-6 bg-gray-50">
                <div class="flex justify-between mb-2 text-xs font-bold text-gray-500">
                    <span>åŒ¯ç‡æ›ç®— (è‡ªè¨‚)</span>
                    <span id="currentRateLabel">1 : 0.22</span>
                </div>
                <div class="flex gap-2 mb-3">
                    <button onclick="setCurrency('KR')" class="flex-1 py-1 text-xs border border-gray-300 rounded bg-white hover:bg-blue-50">éŸ“å¹£ â‚©</button>
                    <button onclick="setCurrency('JP')" class="flex-1 py-1 text-xs border border-gray-300 rounded bg-white hover:bg-red-50">æ—¥å¹£ Â¥</button>
                </div>
                <div class="flex items-center gap-2">
                    <input id="calcInput" type="number" placeholder="å¤–å¹£" class="flex-1 text-xl font-bold p-2 border-b-2 border-gray-300 bg-transparent outline-none">
                    <i class="fa-solid fa-arrow-right text-gray-400"></i>
                    <div class="text-xl font-bold text-green-700">NT$ <span id="calcResult">0</span></div>
                </div>
            </div>

            <div class="flex gap-2 mb-4">
                <input id="expenseDesc" type="text" placeholder="å“é …" class="flex-1 p-3 border-2 border-gray-800 rounded-lg outline-none">
                <input id="expenseAmt" type="number" placeholder="é‡‘é¡" class="w-24 p-3 border-2 border-gray-800 rounded-lg outline-none">
                <button onclick="addExpense()" class="bg-gray-800 text-white px-4 rounded-lg"><i class="fa-solid fa-plus"></i></button>
            </div>

            <div id="walletList" class="space-y-3 pb-8"></div>
            <button onclick="clearExpenses()" class="text-xs text-gray-400 underline w-full text-center">æ¸…ç©ºå¸³æœ¬</button>
        </section>

    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t-2 border-gray-200 flex justify-around items-center py-3 pb-8 z-50">
        <button onclick="switchTab('plan')" class="nav-btn text-gray-800 w-1/3 flex flex-col items-center">
            <i class="fa-solid fa-map-location-dot text-xl mb-1"></i><span class="text-[10px] font-bold">è¡Œç¨‹</span>
        </button>
        <button onclick="switchTab('translate')" class="nav-btn text-gray-400 w-1/3 flex flex-col items-center">
            <i class="fa-solid fa-language text-xl mb-1"></i><span class="text-[10px] font-bold">ç¿»è­¯</span>
        </button>
        <button onclick="switchTab('wallet')" class="nav-btn text-gray-400 w-1/3 flex flex-col items-center">
            <i class="fa-solid fa-wallet text-xl mb-1"></i><span class="text-[10px] font-bold">éŒ¢åŒ…</span>
        </button>
    </nav>

    <div id="editModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm p-6 rounded-2xl shadow-2xl border-2 border-gray-800">
            <h3 class="font-header text-xl mb-4" id="modalTitle">æ–°å¢è¡Œç¨‹</h3>
            <input type="hidden" id="editIndex">
            <div class="space-y-3">
                <div>
                    <label class="text-xs font-bold text-gray-500">æ™‚é–“</label>
                    <input id="modalTime" type="time" class="w-full p-2 border border-gray-300 rounded bg-gray-50">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-500">æ¨™é¡Œ (åœ°é»)</label>
                    <input id="modalAct" type="text" class="w-full p-2 border border-gray-300 rounded">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-500">å‚™è¨»</label>
                    <textarea id="modalNote" rows="3" class="w-full p-2 border border-gray-300 rounded"></textarea>
                </div>
            </div>
            <div class="flex gap-2 mt-6">
                <button onclick="closeModal()" class="flex-1 py-3 bg-gray-100 font-bold rounded-lg text-gray-500">å–æ¶ˆ</button>
                <button onclick="saveItem()" class="flex-1 py-3 bg-gray-800 text-white font-bold rounded-lg">å„²å­˜</button>
            </div>
            <button onclick="deleteItem()" id="btnDelete" class="w-full mt-2 text-red-500 text-xs py-2 hidden">åˆªé™¤æ­¤é …ç›®</button>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒè³‡æ–™ ---
        // é è¨­è¡Œç¨‹ (å¦‚æœ localStorage æ²’è³‡æ–™å°±ç”¨é€™å€‹)
        const defaultTrip = [
            { d: "D0", date: "2/13", week:"(äº”)", city: "Yunlin", lat: 23.7, lon: 120.4, country: "TW", items: [
                { time: "21:30", act: "é›²æ—è™å°¾å‡ºç™¼", note: "é ç´„è¨ˆç¨‹è»Šï¼Œä¿æš–è¡£ç‰©æ‰‹æŒ" },
                { time: "22:16", act: "é›²æ—é«˜éµ", note: "æœ«ç­è»Šå‰å¾€æ¡ƒåœ’ (23:18è‘—)" }
            ]},
            { d: "D1", date: "2/14", week:"(å…­)", city: "Busan", lat: 35.17, lon: 129.07, country: "KR", items: [
                { time: "06:10", act: "é‡‘æµ·æ©Ÿå ´æŠµé”", note: "Money Box æ›éŒ¢ã€Q-CODE" },
                { time: "08:00", act: "æ¾äº­ä¸‰ä»£è±¬è‚‰æ¹¯é£¯", note: "è¥¿é¢å¸‚å ´ã€‚é»ä¸è¾£çµ¦å°å­©" },
                { time: "12:30", act: "ä¸‰äº”äº­äººè”˜é›", note: "è¥¿é¢ç«™é™„è¿‘ï¼Œåˆé¤è£œé«”åŠ›" }
            ]},
            { d: "D2", date: "2/15", week:"(æ—¥)", city: "Busan", lat: 35.17, lon: 129.07, country: "KR", items: [
                { time: "10:30", act: "å¤©ç©ºè† å›Šåˆ—è»Š", note: "å°¾æµ¦å‡ºç™¼ (éœ€é ç´„)" },
                { time: "13:00", act: "æµ·ç†åœ˜è·¯", note: "é€›é›œè²¨ã€æ‹è²¼æ©Ÿã€åƒç³–é¤…" }
            ]},
            { d: "D3", date: "2/16", week:"(ä¸€)", city: "Busan", lat: 35.1, lon: 129.0, country: "KR", items: [
                { time: "09:30", act: "ç”˜å·æ´æ–‡åŒ–æ‘", note: "æ‰¾å°ç‹å­æ‹ç…§ã€é›†ç« " },
                { time: "17:00", act: "é‡œå±±æ¸¯ç™»èˆ¹", note: "æ–°å±±èŒ¶èŠ±è™Ÿ (17:30 æˆªæ­¢)" }
            ]},
            { d: "D4", date: "2/17", week:"(äºŒ)", city: "Nagasaki", lat: 32.75, lon: 129.87, country: "JP", items: [
                { time: "09:00", act: "åšå¤šè»Šç«™", note: "é ˜ç¥¨ã€è²·å…’ç«¥ç¥¨ã€ç«è»Šä¾¿ç•¶" },
                { time: "11:30", act: "é•·å´", note: "ç´¢å– 5 æŠ˜è§€å…‰å¡" },
                { time: "15:30", act: "å¹³å’Œå…¬åœ’", note: "åŸçˆ†è³‡æ–™é¤¨åƒè§€" }
            ]},
            { d: "D5", date: "2/18", week:"(ä¸‰)", city: "Nagasaki", lat: 32.75, lon: 129.87, country: "JP", items: [
                { time: "10:15", act: "ä¼éµæ°´æ—é¤¨", note: "æ­ç¸£ç‡Ÿå·´å£«ï¼Œå‡ºç¤ºæŠ˜æ‰£å¡" },
                { time: "17:15", act: "çœ¼é¡æ©‹", note: "æ‰¾æ„›å¿ƒçŸ³é ­" }
            ]},
            { d: "D6", date: "2/19", week:"(å››)", city: "Hita", lat: 33.32, lon: 130.93, country: "JP", items: [
                { time: "08:30", act: "NIPPON å–è»Š", note: "æª¢æŸ¥é›ªèƒã€ETC" },
                { time: "15:20", act: "æ—¥ç”°è±†ç”°ç”º", note: "é°»é­šé£¯ç³°ã€å¥³å…’ç¯€å¨ƒå¨ƒ" },
                { time: "17:00", act: "å¤©ç€¨æº«æ³‰", note: "æºªä»™é–£ Check-in" }
            ]},
            { d: "D7", date: "2/20", week:"(äº”)", city: "Yufu", lat: 33.26, lon: 131.36, country: "JP", items: [
                { time: "09:40", act: "ä¹å·è‡ªç„¶å‹•ç‰©åœ’", note: "Jungle Bus é¤µç…å­" },
                { time: "15:45", act: "é‡‘é±—æ¹–", note: "çœ‹æ™¨éœ§ã€æ°´ä¸­é³¥å±…" }
            ]},
            { d: "D8", date: "2/21", week:"(å…­)", city: "Oita", lat: 33.23, lon: 131.61, country: "JP", items: [
                { time: "12:30", act: "è±å¾ŒèŒ¶å±‹", note: "åƒé›è‚‰å¤©å©¦ç¾…" },
                { time: "16:30", act: "å¤§åˆ†æ©Ÿå ´", note: "IT241 å›å°ç£" }
            ]}
        ];

        // å¯¦ç”¨å–®å­—åº«
        const phrases = {
            KR: [
                { t: "ä½ å¥½", o: "ì•ˆë…•í•˜ì„¸ìš”", s: "å®‰å¦å“ˆseå”·" },
                { t: "è¬è¬", o: "ê°ì‚¬í•©ë‹ˆë‹¤", s: "åº·æ’’å“ˆå’ªæ­" },
                { t: "å¤šå°‘éŒ¢?", o: "ì–¼ë§ˆì˜ˆìš”?", s: "å–”åª½è€¶å”·?" },
                { t: "è«‹çµ¦æˆ‘é€™å€‹", o: "ì´ê±° ì£¼ì„¸ìš”", s: "ä¼Šå‹¾ æœ±seå”·" },
                { t: "ä¸è¾£", o: "ì•ˆ ë§µê²Œ", s: "å®‰ Me-Gae" },
                { t: "å»æ‰€?", o: "í™”ì¥ì‹¤?", s: "èŠ±æ±Ÿå¸Œ?" },
                { t: "å»é€™è£¡(çµ¦å¸æ©Ÿçœ‹)", o: "ì—¬ê¸°ë¡œ ê°€ì£¼ì„¸ìš”", s: "å”·giç¾… å˜æœ±seå”·" }
            ],
            JP: [
                { t: "ä½ å¥½", o: "ã“ã‚“ã«ã¡ã¯", s: "ç©ºä½ ä¸ƒå“‡" },
                { t: "è¬è¬", o: "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™", s: "é˜¿å“©å˜å¤š" },
                { t: "å¤šå°‘éŒ¢?", o: "ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", s: "ä¼Šå“­æ‹‰ deså¡?" },
                { t: "è«‹çµ¦æˆ‘é€™å€‹", o: "ã“ã‚Œã‚’ãŠé¡˜ã„ã—ã¾ã™", s: "Kore o å–”neè“‹è¥¿åª½æ­»" },
                { t: "å»æ‰€?", o: "ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", s: "Toilet å“‡ å“†å£deså¡?" },
                { t: "æˆ‘è¦æŠ˜æ‰£å¡", o: "Discount Card ãã ã•ã„", s: "Discount Card å“­æ­è³½" },
                { t: "åŠ æ»¿æ²¹", o: "ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼æº€ã‚¿ãƒ³", s: "Regular Man-tan" }
            ]
        };

        // ç‹€æ…‹è®Šæ•¸
        let tripData = [];
        let curDay = 0;
        let curRate = 0.22; 
        
        // --- åˆå§‹åŒ– ---
        function init() {
            // è®€å–è¡Œç¨‹
            const saved = localStorage.getItem('trip_data_2026');
            tripData = saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(defaultTrip));
            
            renderDayNav();
            renderDaily(0);
            renderWallet();

            // ç›£è½åŒ¯ç‡è¨ˆç®—
            document.getElementById('calcInput').addEventListener('input', (e) => {
                document.getElementById('calcResult').innerText = Math.round(e.target.value * curRate);
            });
        }

        // --- æ ¸å¿ƒåŠŸèƒ½ï¼šæ¸²æŸ“è¡Œç¨‹ ---
        function renderDayNav() {
            const nav = document.getElementById('dayNav');
            nav.innerHTML = tripData.map((d, i) => `
                <button onclick="renderDaily(${i})" 
                    class="flex-shrink-0 px-4 py-2 rounded-lg text-xs font-bold transition-all border
                    ${i === curDay ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-400 border-gray-200'}">
                    ${d.d} ${d.date}
                </button>
            `).join('');
        }

        function renderDaily(idx) {
            curDay = idx;
            const day = tripData[idx];
            renderDayNav();
            fetchWeather(day.lat, day.lon, day.city); // æŠ“å¤©æ°£

            const container = document.getElementById('dailyContainer');
            if (day.items.length === 0) {
                container.innerHTML = `<div class="text-center text-gray-300 py-10">é»æ“Šä¸‹æ–¹æŒ‰éˆ•æ–°å¢è¡Œç¨‹</div>`;
            } else {
                container.innerHTML = day.items.map((item, i) => `
                    <div class="sketch-box p-4 relative" onclick="openEditModal(${i})">
                        <div class="flex items-start justify-between mb-1">
                            <span class="bg-yellow-300 text-xs font-black px-2 py-1 rounded border border-black">${item.time}</span>
                            <span class="text-[10px] text-gray-300">âœ ç·¨è¼¯</span>
                        </div>
                        <div class="text-lg font-bold text-blue-700 underline decoration-blue-300 underline-offset-4 cursor-pointer mb-2" 
                             onclick="event.stopPropagation(); openMap('${item.act}', '${day.country}')">
                            ${item.act} <i class="fa-solid fa-location-arrow text-xs ml-1"></i>
                        </div>
                        <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
                            ${item.note || 'ç„¡å‚™è¨»'}
                        </div>
                    </div>
                `).join('');
            }
        }

        // --- åŠŸèƒ½ï¼šåœ°åœ–é€£çµ ---
        function openMap(keyword, country) {
            // ç§»é™¤æ‹¬è™Ÿå…§çš„èªªæ˜æ–‡å­—ï¼Œæé«˜æœå°‹æº–ç¢ºåº¦
            const cleanKey = keyword.split(/[ï¼ˆ(]/)[0];
            const url = country === 'KR' 
                ? `https://map.naver.com/p/search/${cleanKey}`
                : `https://www.google.com/maps/search/?api=1&query=${cleanKey}`;
            window.open(url, '_blank');
        }

        // --- åŠŸèƒ½ï¼šæŠ“å¤©æ°£ (Open-Meteo) ---
        async function fetchWeather(lat, lon, city) {
            const board = document.getElementById('weatherBoard');
            board.classList.remove('hidden');
            document.getElementById('w-city').innerText = city;
            document.getElementById('w-desc').innerText = "æ›´æ–°ä¸­...";
            document.getElementById('w-desc').classList.add('weather-loading');

            try {
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                
                document.getElementById('w-temp').innerText = temp;
                document.getElementById('w-icon').innerText = getWeatherIcon(code);
                document.getElementById('w-desc').innerText = "å³æ™‚æ°£æº«";
                document.getElementById('w-desc').classList.remove('weather-loading');
            } catch (e) {
                document.getElementById('w-desc').innerText = "é›¢ç·š";
            }
        }

        function getWeatherIcon(code) {
            if (code <= 1) return 'â˜€ï¸';
            if (code <= 3) return 'â›…';
            if (code <= 48) return 'ğŸŒ«ï¸';
            if (code <= 67) return 'ğŸŒ§ï¸';
            if (code <= 77) return 'â„ï¸';
            return 'â›ˆï¸';
        }

        // --- åŠŸèƒ½ï¼šç·¨è¼¯è¡Œç¨‹ (Modal) ---
        function openEditModal(itemIdx = -1) {
            const modal = document.getElementById('editModal');
            const day = tripData[curDay];
            
            modal.classList.remove('hidden');
            document.getElementById('editIndex').value = itemIdx;
            
            if (itemIdx === -1) {
                // æ–°å¢
                document.getElementById('modalTitle').innerText = "æ–°å¢è¡Œç¨‹";
                document.getElementById('modalTime').value = "09:00";
                document.getElementById('modalAct').value = "";
                document.getElementById('modalNote').value = "";
                document.getElementById('btnDelete').classList.add('hidden');
            } else {
                // ç·¨è¼¯
                const item = day.items[itemIdx];
                document.getElementById('modalTitle').innerText = "ç·¨è¼¯å…§å®¹";
                document.getElementById('modalTime').value = item.time;
                document.getElementById('modalAct').value = item.act;
                document.getElementById('modalNote').value = item.note;
                document.getElementById('btnDelete').classList.remove('hidden');
            }
        }

        function closeModal() {
            document.getElementById('editModal').classList.add('hidden');
        }

        function saveItem() {
            const idx = parseInt(document.getElementById('editIndex').value);
            const newItem = {
                time: document.getElementById('modalTime').value,
                act: document.getElementById('modalAct').value,
                note: document.getElementById('modalNote').value
            };

            if (!newItem.act) return alert('è«‹è¼¸å…¥æ¨™é¡Œ');

            if (idx === -1) {
                tripData[curDay].items.push(newItem);
            } else {
                tripData[curDay].items[idx] = newItem;
            }
            
            // ä¾æ™‚é–“æ’åº
            tripData[curDay].items.sort((a, b) => a.time.localeCompare(b.time));
            
            saveToLocal();
            renderDaily(curDay);
            closeModal();
        }

        function deleteItem() {
            if(!confirm("ç¢ºå®šåˆªé™¤å—ï¼Ÿ")) return;
            const idx = parseInt(document.getElementById('editIndex').value);
            tripData[curDay].items.splice(idx, 1);
            saveToLocal();
            renderDaily(curDay);
            closeModal();
        }

        function saveToLocal() {
            localStorage.setItem('trip_data_2026', JSON.stringify(tripData));
        }

        function resetData() {
            if(confirm("é€™æœƒé‡ç½®æ‰€æœ‰è¡Œç¨‹å…§å®¹å›åˆ°é è¨­å€¼ï¼Œç¢ºå®šå—ï¼Ÿ")) {
                localStorage.removeItem('trip_data_2026');
                location.reload();
            }
        }

        // --- åŠŸèƒ½ï¼šç¿»è­¯ ---
        function renderPhrases(lang) {
            document.getElementById('btn-lang-kr').className = lang === 'KR' ? 'flex-1 py-2 rounded-lg font-bold border-2 border-gray-800 bg-blue-50 text-blue-800' : 'flex-1 py-2 rounded-lg font-bold border-2 border-gray-200 text-gray-400';
            document.getElementById('btn-lang-jp').className = lang === 'JP' ? 'flex-1 py-2 rounded-lg font-bold border-2 border-gray-800 bg-red-50 text-red-800' : 'flex-1 py-2 rounded-lg font-bold border-2 border-gray-200 text-gray-400';
            
            const list = phrases[lang];
            const colorClass = lang === 'KR' ? 'text-blue-600' : 'text-red-600';
            
            document.getElementById('phraseList').innerHTML = list.map(p => `
                <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                    <div class="text-xs text-gray-400 font-bold mb-1">${p.t}</div>
                    <div class="text-xl font-bold mb-1 ${colorClass}">${p.o}</div>
                    <div class="text-sm text-gray-600 bg-gray-100 px-2 py-1 rounded inline-block">ğŸ—£ï¸ ${p.s}</div>
                </div>
            `).join('');
        }

        // --- åŠŸèƒ½ï¼šéŒ¢åŒ… ---
        function setCurrency(curr) {
            curRate = curr === 'KR' ? 0.024 : 0.22;
            document.getElementById('currentRateLabel').innerText = `1 : ${curRate}`;
            document.getElementById('calcInput').placeholder = curr === 'KR' ? "éŸ“å…ƒ" : "æ—¥å¹£";
            document.getElementById('calcInput').value = "";
            document.getElementById('calcResult').innerText = "0";
        }

        function addExpense() {
            const desc = document.getElementById('expenseDesc').value;
            const amt = document.getElementById('expenseAmt').value;
            if(!desc || !amt) return;
            
            const record = { desc, amt, twd: Math.round(amt * curRate), date: tripData[curDay].date };
            let history = JSON.parse(localStorage.getItem('trip_wallet_2026') || '[]');
            history.unshift(record);
            localStorage.setItem('trip_wallet_2026', JSON.stringify(history));
            
            document.getElementById('expenseDesc').value = '';
            document.getElementById('expenseAmt').value = '';
            renderWallet();
        }

        function renderWallet() {
            const history = JSON.parse(localStorage.getItem('trip_wallet_2026') || '[]');
            document.getElementById('walletList').innerHTML = history.map(h => `
                <div class="flex justify-between items-center bg-white p-3 border border-gray-200 rounded-lg">
                    <div>
                        <div class="font-bold text-gray-800">${h.desc}</div>
                        <div class="text-[10px] text-gray-400">${h.date}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-gray-400">${h.amt}</div>
                        <div class="font-bold text-green-600">$${h.twd}</div>
                    </div>
                </div>
            `).join('');
        }

        function clearExpenses() {
            if(confirm("æ¸…ç©ºå¸³æœ¬?")) {
                localStorage.removeItem('trip_wallet_2026');
                renderWallet();
            }
        }

        // --- é é¢åˆ‡æ› ---
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            
            // å°è¦½åˆ—ç‹€æ…‹
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-gray-800');
                btn.classList.add('text-gray-400');
            });
            event.currentTarget.classList.remove('text-gray-400');
            event.currentTarget.classList.add('text-gray-800');
            
            // ç‰¹æ®Šåˆå§‹åŒ–
            if(id === 'translate') renderPhrases('KR');
        }

        // å•Ÿå‹•
        init();
    </script>
</body>
</html>
