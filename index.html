<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 è·¨åœ‹è¦ªå­å¤§å†’éšª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-paper: #fffdf5; --ink: #2c2c2c; --kr-blue: #0047a0; --jp-red: #d32f2f; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-paper); color: var(--ink); -webkit-tap-highlight-color: transparent; padding-bottom: 100px; }
        .font-header { font-family: 'ZCOOL KuaiLe', cursive; }
        
        /* æ‰‹ç¹ªé¢¨æ ¼é‚Šæ¡† */
        .sketch-box { 
            background: white; 
            border: 2px solid var(--ink); 
            border-radius: 2px 2px 2px 2px;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.1);
        }
        .sketch-rounded {
            border: 2px solid var(--ink);
            border-radius: 15px 255px 15px 25px / 255px 15px 225px 15px;
        }

        /* åˆ†é å‹•ç•« */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* éš±è—å·è»¸ä½†å¯æ»‘å‹• */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* è‡ªå®šç¾© Checkbox */
        .custom-checkbox:checked + div { text-decoration: line-through; color: #9ca3af; }
        .custom-checkbox { accent-color: var(--ink); width: 1.2rem; height: 1.2rem; }
    </style>
</head>
<body>

    <header class="bg-white border-b-2 border-gray-800 p-4 pt-12 text-center sticky top-0 z-40 shadow-sm">
        <h1 class="text-2xl font-header tracking-wider">ğŸ¦• è·¨åœ‹è¦ªå­å¤§å†’éšª</h1>
        <div class="flex justify-center gap-2 mt-1 text-xs font-bold text-gray-500">
            <span>2026.02.13</span> <i class="fa-solid fa-arrow-right"></i> <span>02.21</span>
        </div>
    </header>

    <main class="p-4 max-w-lg mx-auto">
        
        <section id="plan" class="tab-content active">
            <div class="flex overflow-x-auto gap-2 pb-2 mb-4 no-scrollbar" id="dayNav">
                </div>

            <div id="dailyContainer" class="space-y-4">
                </div>
        </section>

        <section id="wallet" class="tab-content">
            <div class="sketch-box p-4 mb-6 rounded-xl relative overflow-hidden">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-header text-lg"><i class="fa-solid fa-calculator"></i> åŒ¯ç‡æ›ç®—</h3>
                    <div class="flex bg-gray-100 rounded-lg p-1 text-xs font-bold">
                        <button onclick="setCurrency('KR')" id="btn-KR" class="px-3 py-1 rounded transition-all bg-white shadow text-blue-700">éŸ“å¹£ â‚©</button>
                        <button onclick="setCurrency('JP')" id="btn-JP" class="px-3 py-1 rounded transition-all text-gray-500">æ—¥å¹£ Â¥</button>
                    </div>
                </div>
                
                <div class="flex items-end gap-2 mb-2">
                    <div class="flex-1">
                        <label class="text-xs text-gray-500 font-bold ml-1">å¤–å¹£é‡‘é¡</label>
                        <input id="calcInput" type="number" class="w-full text-2xl font-bold p-2 border-b-2 border-gray-300 focus:border-black outline-none bg-transparent" placeholder="0">
                    </div>
                    <div class="pb-2 text-xl text-gray-400">Ã—</div>
                    <div class="w-20">
                        <label class="text-xs text-gray-500 font-bold ml-1">åŒ¯ç‡</label>
                        <input id="calcRate" type="number" step="0.001" class="w-full text-center p-2 border-b-2 border-gray-300 outline-none bg-transparent font-mono text-sm" value="0.024">
                    </div>
                </div>
                <div class="bg-gray-50 p-3 rounded text-right">
                    <span class="text-xs text-gray-500">ç´„å°å¹£</span>
                    <div class="text-2xl font-bold text-green-600">NT$ <span id="calcResult">0</span></div>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="font-header text-lg mb-2 pl-1">âœï¸ è¨˜ä¸€ç­†</h3>
                <div class="flex gap-2 mb-2">
                    <input id="expenseDesc" type="text" placeholder="å“é … (å¦‚: çƒ¤è‚‰)" class="flex-1 p-3 border-2 border-gray-800 rounded-lg outline-none">
                    <input id="expenseAmt" type="number" placeholder="å¤–å¹£é‡‘é¡" class="w-24 p-3 border-2 border-gray-800 rounded-lg outline-none">
                </div>
                <button onclick="addExpense()" class="w-full bg-gray-800 text-white font-bold py-3 rounded-lg active:scale-95 transition">åŠ å…¥ä»Šæ—¥å¸³æœ¬</button>
            </div>

            <div id="walletList" class="space-y-6">
                </div>
            
            <button onclick="clearExpenses()" class="w-full text-center text-xs text-gray-400 mt-8 underline">æ¸…é™¤æ‰€æœ‰è¨˜å¸³è³‡æ–™</button>
        </section>

        <section id="shopping" class="tab-content">
            <h2 class="font-header text-xl mb-4 pl-1">ğŸ›ï¸ å¿…è²·æ¸…å–®</h2>
            
            <div class="flex gap-2 mb-4">
                <input id="shopInput" type="text" placeholder="è¼¸å…¥æƒ³è²·çš„æ±è¥¿..." class="flex-1 p-3 border-2 border-gray-800 rounded-lg outline-none shadow-sm">
                <button onclick="addShopItem()" class="bg-yellow-400 border-2 border-gray-800 text-black px-4 rounded-lg font-bold shadow-sm active:translate-y-1"><i class="fa-solid fa-plus"></i></button>
            </div>

            <div id="shopList" class="space-y-2">
                </div>
        </section>

        <section id="info" class="tab-content">
            <h2 class="font-header text-xl mb-4 pl-1">â„¹ï¸ å¯¦ç”¨è³‡è¨Š</h2>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="sketch-box p-3 bg-blue-50">
                    <div class="text-blue-800 font-bold mb-1"><i class="fa-solid fa-phone"></i> éŸ“åœ‹å ±è­¦</div>
                    <div class="text-2xl font-black">112</div>
                </div>
                <div class="sketch-box p-3 bg-red-50">
                    <div class="text-red-800 font-bold mb-1"><i class="fa-solid fa-phone"></i> æ—¥æœ¬å ±è­¦</div>
                    <div class="text-2xl font-black">110</div>
                </div>
            </div>

            <div class="sketch-box p-4 mb-4">
                <h3 class="font-bold mb-2 border-b pb-2">ğŸš— è‡ªé§•å°å¹«æ‰‹</h3>
                <p class="mb-2"><span class="bg-black text-white px-2 py-0.5 rounded text-xs">åŠ æ²¹</span> Regular Man-tan (ç´…)</p>
                <p><span class="bg-black text-white px-2 py-0.5 rounded text-xs">å°èˆª</span> è«‹å¹«æˆ‘è¨­å®š MapCode</p>
            </div>
        </section>

    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t-2 border-gray-200 flex justify-around items-center py-3 pb-8 z-50 shadow-[0_-4px_10px_rgba(0,0,0,0.05)]">
        <button onclick="switchTab('plan')" class="nav-btn text-gray-800 flex flex-col items-center w-1/4">
            <i class="fa-solid fa-calendar-days text-xl mb-1"></i><span class="text-[10px] font-bold">è¡Œç¨‹</span>
        </button>
        <button onclick="switchTab('wallet')" class="nav-btn text-gray-400 flex flex-col items-center w-1/4">
            <i class="fa-solid fa-wallet text-xl mb-1"></i><span class="text-[10px] font-bold">è¨˜å¸³</span>
        </button>
        <button onclick="switchTab('shopping')" class="nav-btn text-gray-400 flex flex-col items-center w-1/4">
            <i class="fa-solid fa-cart-shopping text-xl mb-1"></i><span class="text-[10px] font-bold">å¿…è²·</span>
        </button>
        <button onclick="switchTab('info')" class="nav-btn text-gray-400 flex flex-col items-center w-1/4">
            <i class="fa-solid fa-circle-info text-xl mb-1"></i><span class="text-[10px] font-bold">è³‡è¨Š</span>
        </button>
    </nav>

    <script>
        // --- è³‡æ–™è¨­å®š ---
        const tripData = [
            { id: 0, date: "2/13 (äº”)", loc: "Yunlin", country: "TW", title: "ç¬¬ä¸€éšæ®µï¼šå°ç£å‡ºç™¼", weatherCity: "Yunlin", items: [
                { time: "21:30", title: "é›²æ—è™å°¾å‡ºç™¼", note: "é ç´„è¨ˆç¨‹è»Šã€‚è«‹æå‰é ç•™ç·©è¡æ™‚é–“ï¼Œå‚™å¦¥ä¿æš–è¡£ç‰©æ‰‹æŒã€‚" },
                { time: "22:16", title: "é›²æ—é«˜éµ (æœ«ç­)", note: "22:16ç™¼ â” 23:18 æ¡ƒåœ’è‘—ã€‚ä¸‹è»Šè¡æ©Ÿæ·æˆ–è¨ˆç¨‹è»Šã€‚" },
                { time: "23:45", title: "å‰å¾€æ¡ƒæ©Ÿ T1", note: "3æ¨“å‡ºå¢ƒå¤§å»³ã€‚åŠå¤œå¾ˆçï¼Œè«‹æŠ“ç·Šæ™‚é–“ä¼‘æ¯å„²å­˜é«”åŠ›ã€‚" }
            ]},
            { id: 1, date: "2/14 (å…­)", loc: "Busan", country: "KR", title: "é‡œå±±è¥¿é¢ (æƒ…äººç¯€)", weatherCity: "Busan", items: [
                { time: "06:10", title: "æŠµé”é‡‘æµ·æ©Ÿå ´", note: "Money Boxæ›éŒ¢(06:00é–‹)ã€‚å‡ºå¤§é–€æœƒå†·ï¼Œå¹«å°å­©ç©¿ç™¼ç†±è¡£ã€‚æº–å‚™è­·ç…§/Q-CODEã€‚" },
                { time: "07:15", title: "Jumbo Taxi", note: "ç´„â‚©35,000ã€‚4äºº+è¡Œæå‹™å¿…æ­å¤§å‹è»Šã€‚å…ˆå»é£¯åº—å¯„æ”¾è¡Œæã€‚" },
                { time: "08:00", title: "æ¾äº­ä¸‰ä»£è±¬è‚‰æ¹¯é£¯", note: "è¥¿é¢å¸‚å ´ã€‚çµ¦å°å­©é»ä¸è¾£ã€‚è¦é†¬èª¿é¹¹æ·¡ï¼ŒéŸ­èœåŠ æ¹¯ã€‚" },
                { time: "09:30", title: "é‡œç”°å¸‚å ´ & å¸‚æ°‘å…¬åœ’", note: "æœ‰è¶…å¤§éŠæ¨‚å ´æ”¾é›»ã€‚è‹¥å¤ªå†·å°±å»å’–å•¡å»³ã€‚" },
                { time: "12:30", title: "åˆé¤ï¼šä¸‰äº”äº­äººè”˜é›", note: "è¥¿é¢ç«™é™„è¿‘ã€‚é›è‚‰ç‡‰å¾ˆçˆ›ï¼Œé©åˆè£œé«”åŠ›ã€‚" },
                { time: "16:00", title: "é£¯åº—è£œçœ  (é‡è¦)", note: "ç´…çœ¼ç­æ©Ÿå¾Œå…¨å®¶æœƒå¾ˆçï¼Œå‹™å¿…ç¡2å°æ™‚ï¼Œæ‰èƒ½æ‡‰ä»˜æ™šä¸Šäººæ½®ã€‚" },
                { time: "18:30", title: "æ™šé¤ï¼šé‡œå±±çƒ¤è‚‹æ’", note: "é£¯åº—æ–œå°é¢ã€‚æƒ…äººç¯€æœƒæ’éšŠï¼Œçˆ¸çˆ¸å…ˆå»æ’ã€‚é»åŸå‘³çµ¦å°å­©ã€‚" }
            ]},
            { id: 2, date: "2/15 (æ—¥)", loc: "Haeundae", country: "KR", title: "æµ·é›²å°èˆ‡è† å›Šåˆ—è»Š", weatherCity: "Busan", items: [
                { time: "09:30", title: "å‰å¾€å°¾æµ¦ (Mipo)", note: "Kakao Tå«è»Šã€‚è¨­å®šç›®çš„åœ°ï¼šå°¾æµ¦å¤©ç©ºè† å›Šä¹˜è»Šè™•ã€‚" },
                { time: "10:30", title: "å¤©ç©ºè† å›Šåˆ—è»Š", note: "å°¾æµ¦ â” é’æ²™æµ¦ (éœ€2é€±å‰å®˜ç¶²æ¶ç¥¨)ã€‚è»Šç¨‹30åˆ†ã€‚" },
                { time: "11:10", title: "åˆé¤ï¼šç±³å¯¶å®¶", note: "æµ·é›²å°ç¸½åº—æˆ–é’æ²™æµ¦åº—ã€‚é†ƒæµ·é®®ã€é‹é£¯(å°å­©æ„›åƒ)ã€‚" },
                { time: "13:00", title: "æµ·ç†åœ˜è·¯", note: "Dualholic(é›œè²¨)ã€Fromluck(æ–‡å…·)ã€äººç”Ÿå››æ ¼æ‹è²¼ã€‚åƒç³–é¤…ã€‚" },
                { time: "14:40", title: "æ–°ä¸–ç•Œç™¾è²¨", note: "ä¸‹åˆæµ·é¢¨å¤§ï¼Œèº²é€²å®¤å…§é¿å¯’ã€‚å‚™æ¡ˆï¼šSpa Landã€‚" }
            ]},
            { id: 3, date: "2/16 (ä¸€)", loc: "Busan Port", country: "KR", title: "é‡œå±±æœ€å¾Œå·¡ç¦® & æ­èˆ¹", weatherCity: "Busan", items: [
                { time: "09:00", title: "æ¸¯å£å¯„è¡Œæ", note: "åœ‹éš›å®¢é‹ç¢¼é ­ 2F/3Fã€‚è¼•è£å»ç”˜å·æ´ã€‚" },
                { time: "09:30", title: "ç”˜å·æ´æ–‡åŒ–æ‘", note: "æ­è¨ˆç¨‹è»Šä¸Šå±±ã€‚å¿…åšï¼šå°ç‹å­æ‹ç…§ã€é›†ç« ã€‚" },
                { time: "13:30", title: "å—æµ¦æ´åˆ†é ­é€›", note: "æ¯å¥³ï¼šå…‰å¾©è·¯ã€Artboxã€‚çˆ¸çˆ¸ï¼šä¸­å¤®ç«™å·¥å…·è¡—ã€‚é›†åˆï¼šBIFFæ˜Ÿå·´å…‹ã€‚" },
                { time: "17:00", title: "å›æ¸¯å£ç™»èˆ¹", note: "æ–°å±±èŒ¶èŠ±è™Ÿã€‚3Fæ«ƒæª¯å ±åˆ° (17:30å‰)ã€‚è¶…å•†è²·æ°´ã€æšˆèˆ¹è—¥ã€‚" }
            ]},
            { id: 4, date: "2/17 (äºŒ)", loc: "Nagasaki", country: "JP", title: "é•·å´ï¼šç«è»Šèˆ‡åŸçˆ†", weatherCity: "Nagasaki", items: [
                { time: "07:30", title: "åšå¤šæ¸¯å…¥å¢ƒ", note: "è¨ˆç¨‹è»Šæ—¥æ–‡ï¼šåšå¤šé§…ã®åšå¤šå£ã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚è‡ªå‹•é–€å‹¿æ‰‹æ‹‰ã€‚" },
                { time: "09:00", title: "åšå¤šè»Šç«™è²·ç¥¨", note: "ç¶ è‰²çª—å£ã€‚ä»»å‹™ï¼šæ¶è¨‚787ç³»åŒ…å»‚ã€è²·4æ­²å…’ç«¥ç¥¨ã€‚" },
                { time: "10:04", title: "æµ·é·—è™Ÿæ¥åŠ›", note: "ç´…ç·šJRä¸­å¤®æ”¹æœ­å£ã€‚11:00æ­¦é›„æº«æ³‰åŒæœˆå°æ›æ–°å¹¹ç·šã€‚" },
                { time: "11:30", title: "é•·å´ Check-in", note: "ç´¢å–ï¼šNagasaki Discount Card (5æŠ˜å¡)ã€‚å¯„æ”¾è¡Œæã€‚" },
                { time: "12:30", title: "åˆé¤ï¼šæ–‡æ²»éƒè±¬æ’", note: "è·¯é¢é›»è»Šã€Œå¤§å­¸é†«é™¢ã€ç«™ã€‚æµœå£åº—ã€‚" },
                { time: "15:30", title: "å¹³å’Œå…¬åœ’", note: "åŸçˆ†è³‡æ–™é¤¨ â” ä¸­å¿ƒç¢‘ â” å¹³å’Œå…¬åœ’ã€‚åƒç¦ç ‚å±‹é•·å´è›‹ç³•ã€‚" },
                { time: "16:00", title: "COCOWALK", note: "æ‘©å¤©è¼ª(ç”¨æŠ˜æ‰£å¡)ã€æ©¡å­å…±å’Œåœ‹ã€‚æ™šé¤åƒ Ringer Hut å¼·æ£’éºµã€‚" }
            ]},
            { id: 5, date: "2/18 (ä¸‰)", loc: "Nagasaki", country: "JP", title: "é•·å´ï¼šä¼éµèˆ‡æ­·å²", weatherCity: "Nagasaki", items: [
                { time: "10:15", title: "ä¼éµæ°´æ—é¤¨", note: "é•·å´ç«™å‰æ±å£æ­ç¸£ç‡Ÿå·´å£«(å¾€ç¶²å ´)ã€‚å‡ºç¤ºæŠ˜æ‰£å¡5æŠ˜ã€‚" },
                { time: "15:30", title: "è»è‰¦å³¶æ•¸ä½åšç‰©é¤¨", note: "ä¸­å¤®æ©‹ä¸‹è»Šã€‚VRé«”é©—(5æŠ˜)ã€‚" },
                { time: "17:15", title: "çœ¼é¡æ©‹", note: "è·¯é¢é›»è»Šã€Œçœ¼é¡æ©‹ã€ç«™ã€‚å°‹æ‰¾æ„›å¿ƒçŸ³é ­ã€‚" }
            ]},
            { id: 6, date: "2/19 (å››)", loc: "Oita", country: "JP", title: "è‡ªé§•å†’éšªï¼šå¤§åˆ†å±±å€", weatherCity: "Hita", items: [
                { time: "08:30", title: "å–è»Š NIPPON", note: "AMU PLAZA æ–°é¤¨1Fã€‚ç¢ºèªETCã€é›ªèƒã€‚å³é§•æ³¨æ„ã€‚" },
                { time: "12:00", title: "ç­‘å‰å—ä¹‹é‡Œ", note: "é“ã®é§…åˆé¤ã€‚å¿…åƒç­‘å‰ç…®ã€‚" },
                { time: "13:40", title: "å¤§åˆ€æ´—å¹³å’Œé¤¨", note: "çœ‹é›¶å¼æˆ°æ©Ÿã€‚" },
                { time: "15:20", title: "æ—¥ç”°è±†ç”°ç”º", note: "çœ‹å¥³å…’ç¯€å¨ƒå¨ƒã€‚è²·é°»é­šé£¯ç³°ã€‚" },
                { time: "16:20", title: "AEON è¶…å¸‚è£œçµ¦", note: "æ—¥ç”°åº—ã€‚è²·ç‰›å¥¶ã€æ°´ã€è»Šä¸Šé›¶é£Ÿã€æ—¥æœ¬è‰è“ã€‚" },
                { time: "17:00", title: "å¤©ç€¨æº«æ³‰ æºªä»™é–£", note: "é›»è©±å°èˆªï¼š0973-57-2355ã€‚é€²æº«æ³‰è¡—è·¯çª„æ…¢è¡Œã€‚" }
            ]},
            { id: 7, date: "2/20 (äº”)", loc: "Yufuin", country: "JP", title: "ä¹å·å‹•ç‰©åœ’ & ç”±å¸ƒé™¢", weatherCity: "Yufu", items: [
                { time: "09:30", title: "å‰å¾€å‹•ç‰©åœ’", note: "MapCode: 46 634 565ã€‚èµ°å¤§åˆ†è‡ªå‹•è»Šé“è¼ƒä¸æšˆã€‚" },
                { time: "09:40", title: "ä¹å·è‡ªç„¶å‹•ç‰©åœ’", note: "é–€å£ç›´æ¥é ç´„ Jungle Busã€‚é¤µé£Ÿå¤¾å­è¦æ‹¿ç©©ã€‚" },
                { time: "14:30", title: "åˆé¤ï¼šç”±å¸ƒé™¢é‡œé£¯å¿ƒ", note: "é›»è©±ï¼š0977-84-3111ã€‚è±å¾Œç‰›é‡œé£¯ä¸‰åƒã€‚" },
                { time: "15:45", title: "é‡‘é±—æ¹–", note: "çœ‹æ™¨éœ§èˆ‡æ°´ä¸­é³¥å±…ã€‚æº«æ³‰æ°´+åœ°ä¸‹æ°´äº¤åŒ¯ã€‚" },
                { time: "18:45", title: "å¤§åˆ†é‚„è»Š", note: "å¤§åˆ†ç«™å‰ç‡Ÿæ¥­æ‰€ã€‚å‹™å¿…åŠ æ»¿æ²¹ä¿ç•™æ”¶æ“šã€‚" }
            ]},
            { id: 8, date: "2/21 (å…­)", loc: "Oita", country: "JP", title: "æœ€å¾Œè¡åˆºï¼šå¤§åˆ†æ©Ÿå ´", weatherCity: "Oita", items: [
                { time: "09:00", title: "è¡Œæå¯„æ”¾", note: "é£¯åº—æ«ƒæª¯ (ç­‰ä¸‹è¦å›ä¾†æ­å·´å£«)ã€‚" },
                { time: "10:00", title: "AMU PLAZA", note: "1Fè±å¾Œåº­è²·ä¼´æ‰‹ç¦®(èŠå®¶ã€é…¸æ©˜æ±ã€é¦™è‡)ã€‚" },
                { time: "12:30", title: "åˆé¤ï¼šè±å¾ŒèŒ¶å±‹", note: "å¿…åƒå¤§åˆ†é›è‚‰å¤©å©¦ç¾…(Toriten)ã€‚" },
                { time: "13:50", title: "å‰å¾€å·´å£«ç«™", note: "å¤§åˆ†è»Šç«™å‰6è™Ÿä¹˜è»Šè™•ã€‚æ­14:00æˆ–14:15(åº•ç·š)ã€‚" },
                { time: "15:15", title: "æ©Ÿå ´å ±åˆ°", note: "IT241 (16:30èµ·é£›)ã€‚æœ€å¾Œæ¡è²·ï¼š2Fç©ºä¹‹ç«™ã€‚" }
            ]}
        ];

        let currentDayIndex = 0;
        let currentCurrency = 'KR'; // 'KR' or 'JP'
        const rates = { 'KR': 0.024, 'JP': 0.215 }; // é è¨­åŒ¯ç‡

        // --- åˆå§‹åŒ– ---
        function init() {
            renderDayNav();
            renderDayContent(0);
            renderWalletList();
            renderShopList();
            
            // åŒ¯ç‡è¨ˆç®—æ©Ÿç›£è½
            document.getElementById('calcInput').addEventListener('input', calculate);
            document.getElementById('calcRate').addEventListener('input', calculate);
        }

        // --- è¡Œç¨‹åŠŸèƒ½ ---
        function renderDayNav() {
            const nav = document.getElementById('dayNav');
            nav.innerHTML = tripData.map((d, i) => `
                <button onclick="renderDayContent(${i})" 
                    class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-bold transition-all border border-gray-300
                    ${i === 0 ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-500'}" id="day-btn-${i}">
                    ${d.date}
                </button>
            `).join('');
        }

        function renderDayContent(index) {
            currentDayIndex = index;
            const data = tripData[index];
            const container = document.getElementById('dailyContainer');
            
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('#dayNav button').forEach((btn, i) => {
                if(i === index) {
                    btn.classList.add('bg-gray-800', 'text-white', 'border-gray-800');
                    btn.classList.remove('bg-white', 'text-gray-500');
                } else {
                    btn.classList.remove('bg-gray-800', 'text-white', 'border-gray-800');
                    btn.classList.add('bg-white', 'text-gray-500');
                }
            });

            // è‡ªå‹•åˆ‡æ›åŒ¯ç‡å»ºè­° (åƒ…ç¬¬ä¸€æ¬¡é€²å…¥è©²åœ‹å¤©æ•¸æ™‚æç¤ºï¼Œé€™è£¡ç°¡å–®åšï¼šç›´æ¥åˆ‡æ›)
            if(data.country === 'JP' && currentCurrency !== 'JP') setCurrency('JP');
            if(data.country === 'KR' && currentCurrency !== 'KR') setCurrency('KR');

            const weatherUrl = `https://www.accuweather.com/en/search-locations?query=${data.weatherCity}`;

            container.innerHTML = `
                <div class="flex justify-between items-center px-1 mb-2">
                    <h2 class="font-header text-xl text-blue-900">${data.title}</h2>
                    <a href="${weatherUrl}" target="_blank" class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-bold">
                        <i class="fa-solid fa-cloud-sun"></i> ç•¶åœ°å¤©æ°£
                    </a>
                </div>
            ` + data.items.map(item => `
                <div class="sketch-box p-4 relative">
                    <div class="flex justify-between items-start mb-2">
                        <span class="bg-yellow-300 text-xs font-black px-2 py-1 rounded border border-black shadow-sm">${item.time}</span>
                        <button onclick="openMap('${item.title}', '${data.country}')" class="text-gray-400 hover:text-blue-600 active:scale-90 transition">
                            <i class="fa-solid fa-map-location-dot text-xl"></i>
                        </button>
                    </div>
                    <h3 class="font-bold text-lg mb-1">${item.title}</h3>
                    <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded border border-dashed border-gray-300">
                        <i class="fa-solid fa-circle-check text-green-500 mr-1"></i> ${item.note}
                    </div>
                </div>
            `).join('');
        }

        function openMap(query, country) {
            let url;
            // è™•ç†ç‰¹æ®Šé—œéµå­—ä»¥æé«˜åœ°åœ–æº–ç¢ºåº¦
            const cleanQuery = query.split("ï¼š")[0].split(" ")[0]; 
            
            if (country === 'KR') {
                url = `https://map.naver.com/p/search/${cleanQuery}`;
            } else {
                url = `https://www.google.com/maps/search/?api=1&query=${cleanQuery}`;
            }
            window.open(url, '_blank');
        }

        // --- éŒ¢åŒ…åŠŸèƒ½ ---
        function setCurrency(curr) {
            currentCurrency = curr;
            document.getElementById('calcRate').value = rates[curr];
            
            // æ›´æ–°æŒ‰éˆ•å¤–è§€
            const btnKR = document.getElementById('btn-KR');
            const btnJP = document.getElementById('btn-JP');
            
            if(curr === 'KR') {
                btnKR.className = "px-3 py-1 rounded transition-all bg-white shadow text-blue-700 font-bold border border-gray-200";
                btnJP.className = "px-3 py-1 rounded transition-all text-gray-400";
            } else {
                btnJP.className = "px-3 py-1 rounded transition-all bg-white shadow text-red-700 font-bold border border-gray-200";
                btnKR.className = "px-3 py-1 rounded transition-all text-gray-400";
            }
            calculate();
        }

        function calculate() {
            const input = parseFloat(document.getElementById('calcInput').value) || 0;
            const rate = parseFloat(document.getElementById('calcRate').value) || 0;
            document.getElementById('calcResult').innerText = Math.round(input * rate).toLocaleString();
        }

        function addExpense() {
            const desc = document.getElementById('expenseDesc').value;
            const amt = document.getElementById('expenseAmt').value;
            if(!desc || !amt) return alert('è«‹è¼¸å…¥å®Œæ•´è³‡è¨Š');

            const todayTitle = tripData[currentDayIndex].date; // ä½¿ç”¨ç•¶å‰é¸ä¸­çš„è¡Œç¨‹æ—¥æœŸä½œç‚ºè¨˜å¸³æ—¥æœŸ
            const newRecord = {
                id: Date.now(),
                desc: desc,
                amt: parseInt(amt),
                curr: currentCurrency,
                date: todayTitle
            };

            let expenses = JSON.parse(localStorage.getItem('trip2026_expenses')) || [];
            expenses.push(newRecord);
            localStorage.setItem('trip2026_expenses', JSON.stringify(expenses));
            
            document.getElementById('expenseDesc').value = '';
            document.getElementById('expenseAmt').value = '';
            renderWalletList();
        }

        function renderWalletList() {
            const expenses = JSON.parse(localStorage.getItem('trip2026_expenses')) || [];
            const container = document.getElementById('walletList');
            
            if(expenses.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-400 py-10">ç›®å‰æ²’æœ‰è¨˜å¸³è³‡æ–™</div>';
                return;
            }

            // Group by Date
            const grouped = expenses.reduce((acc, curr) => {
                if(!acc[curr.date]) acc[curr.date] = [];
                acc[curr.date].push(curr);
                return acc;
            }, {});

            let html = '';
            for (const [date, items] of Object.entries(grouped)) {
                let dayTotal = 0;
                const itemsHtml = items.map(item => {
                    const rate = rates[item.curr] || 0.22; // ç°¡å–®ä¼°ç®—
                    const twd = Math.round(item.amt * rate);
                    dayTotal += twd;
                    const symbol = item.curr === 'KR' ? 'â‚©' : 'Â¥';
                    return `
                        <div class="flex justify-between items-center text-sm py-1 border-b border-gray-100 last:border-0">
                            <span class="text-gray-700">${item.desc}</span>
                            <div class="text-right">
                                <div class="font-mono font-bold">${symbol}${item.amt}</div>
                                <div class="text-[10px] text-gray-400">â‰ˆ $${twd}</div>
                            </div>
                        </div>
                    `;
                }).join('');

                html += `
                    <div class="bg-white border-2 border-gray-100 rounded-lg p-3 shadow-sm">
                        <div class="flex justify-between items-center mb-2 pb-1 border-b-2 border-gray-800">
                            <h4 class="font-bold text-gray-800">${date}</h4>
                            <span class="text-xs font-bold bg-gray-200 px-2 rounded">ç¸½è¨ˆç´„ $${dayTotal}</span>
                        </div>
                        <div class="space-y-1">${itemsHtml}</div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        function clearExpenses() {
            if(confirm('ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰è¨˜å¸³å—ï¼Ÿç„¡æ³•å¾©åŸå–”ï¼')) {
                localStorage.removeItem('trip2026_expenses');
                renderWalletList();
            }
        }

        // --- è³¼ç‰©æ¸…å–®åŠŸèƒ½ ---
        function addShopItem() {
            const input = document.getElementById('shopInput');
            const val = input.value.trim();
            if(!val) return;

            let list = JSON.parse(localStorage.getItem('trip2026_shop')) || [];
            list.push({ id: Date.now(), text: val, checked: false });
            localStorage.setItem('trip2026_shop', JSON.stringify(list));
            input.value = '';
            renderShopList();
        }

        function toggleShopItem(id) {
            let list = JSON.parse(localStorage.getItem('trip2026_shop')) || [];
            const idx = list.findIndex(i => i.id === id);
            if(idx > -1) {
                list[idx].checked = !list[idx].checked;
                localStorage.setItem('trip2026_shop', JSON.stringify(list));
                renderShopList(); // é‡æ–°æ¸²æŸ“ä»¥å¥—ç”¨åˆªé™¤ç·šæ¨£å¼
            }
        }

        function deleteShopItem(id) {
            let list = JSON.parse(localStorage.getItem('trip2026_shop')) || [];
            const newList = list.filter(i => i.id !== id);
            localStorage.setItem('trip2026_shop', JSON.stringify(newList));
            renderShopList();
        }

        function renderShopList() {
            const list = JSON.parse(localStorage.getItem('trip2026_shop')) || [];
            const container = document.getElementById('shopList');
            
            container.innerHTML = list.map(item => `
                <div class="flex items-center bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                    <input type="checkbox" class="custom-checkbox mr-3" 
                        onchange="toggleShopItem(${item.id})" ${item.checked ? 'checked' : ''}>
                    <div class="flex-1 font-medium ${item.checked ? 'text-gray-300 line-through' : 'text-gray-800'}">
                        ${item.text}
                    </div>
                    <button onclick="deleteShopItem(${item.id})" class="text-gray-300 hover:text-red-500 px-2">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
            `).join('');
        }

        // --- é é¢åˆ‡æ› ---
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            // å°è¦½åˆ—æ¨£å¼æ›´æ–°
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-gray-800');
                btn.classList.add('text-gray-400');
            });
            event.currentTarget.classList.remove('text-gray-400');
            event.currentTarget.classList.add('text-gray-800');
        }

        // å•Ÿå‹•
        init();
    </script>
</body>
</html>
