<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 日系家族手帳</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg-color: #fdfaf1; --accent-color: #8c7851; --card-bg: #ffffff; --text-color: #4a4a4a; }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Arial, "Noto Sans TC", sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .day-tab.active { background-color: #f3e9d2; border-color: var(--accent-color); color: var(--accent-color); transform: scale(1.05); }
        .schedule-card { background: var(--card-bg); border-radius: 16px; border-left: 4px solid #e0d5c1; transition: all 0.3s; }
        .input-minimal { border: none; background: transparent; border-bottom: 1px solid #eee; outline: none; width: 100%; }
        .weather-badge { background: #fff; border: 1px solid #f0e5cf; border-radius: 20px; padding: 2px 10px; font-size: 0.75rem; color: #8c7851; }
        .sticky-nav { background: rgba(253, 250, 241, 0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="pb-20">

    <header class="p-6 text-center">
        <h1 class="text-xl font-medium tracking-widest text-[#8c7851]">2026 TRAVEL JOURNAL</h1>
        <p class="text-[10px] text-gray-400 mt-1 uppercase tracking-tighter">Family Trip: Busan & Kyushu</p>
    </header>

    <nav class="sticky-nav sticky top-0 z-50 px-4 py-3 flex gap-3 overflow-x-auto no-scrollbar">
        <button onclick="switchDay(0)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab0">D0 2/13</button>
        <button onclick="switchDay(1)" class="day-btn day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab1">D1 2/14</button>
        <button onclick="switchDay(2)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab2">D2 2/15</button>
        <button onclick="switchDay(3)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab3">D3 2/16</button>
        <button onclick="switchDay(4)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab4">D4 2/17</button>
        <button onclick="switchDay(5)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab5">D5 2/18</button>
        <button onclick="switchDay(6)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab6">D6 2/19</button>
        <button onclick="switchDay(7)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab7">D7 2/20</button>
        <button onclick="switchDay(8)" class="day-tab flex-shrink-0 px-5 py-2 rounded-full border border-transparent font-bold text-sm bg-white shadow-sm" id="tab8">D8 2/21</button>
    </nav>

    <main id="app-content" class="p-5">
        </main>

    <script>
        const tripData = {
            rate: 0.024,
            currentDay: 0,
            days: {
                0: { date: "2/13", city: "雲林/桃園", weather: "16°C", rate: 1, items: [
                    { time: "21:30", loc: "虎尾家", note: "開車出發", map: "雲林縣虎尾鎮埒內217-5號" },
                    { time: "22:16", loc: "雲林高鐵站", note: "末班車前往桃園", map: "高鐵雲林站" }
                ], expenses: [] },
                1: { date: "2/14", city: "釜山", weather: "2°C ~ 10°C", rate: 0.024, items: [
                    { time: "06:10", loc: "釜山金海機場", note: "濟州航空 7C 6164 (T1)", map: "Gimhae International Airport" },
                    { time: "09:00", loc: "Queens Hotel Seomyeon", note: "寄放行李", map: "Queens Hotel Seomyeon" }
                ], expenses: [] },
                5: { date: "2/18", city: "長崎", weather: "4°C ~ 11°C", rate: 0.22, items: [
                    { time: "10:00", loc: "長崎企鵝水族館", note: "搭乘巴士前往", map: "長崎企鵝水族館" },
                    { time: "13:30", loc: "長崎港海鮮市場", note: "海膽蓋飯午餐", map: "長崎港 餐廳" }
                ], expenses: [] }
            }
        };

        function switchDay(d) {
            tripData.currentDay = d;
            render();
        }

        function addSchedule() {
            const day = tripData.days[tripData.currentDay];
            if (!day) return;
            day.items.push({ time: "12:00", loc: "新景點", note: "備註內容", map: "" });
            render();
        }

        function addExpense() {
            const day = tripData.days[tripData.currentDay];
            if (!day) return;
            day.expenses.push({ name: "新支出", cost: 0 });
            render();
        }

        function render() {
            const container = document.getElementById('app-content');
            const day = tripData.days[tripData.currentDay] || { city: "自由行", weather: "未知", items: [], expenses: [], rate: 0.22 };
            
            // 更新 Tab 樣式
            document.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab${tripData.currentDay}`).classList.add('active');

            let html = `
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <span class="text-xs font-bold text-gray-400">LOCATION</span>
                        <h2 class="text-2xl font-medium">${day.city}</h2>
                    </div>
                    <div class="weather-badge"><i class="fas fa-temperature-low mr-1"></i>${day.weather}</div>
                </div>

                <div class="space-y-4 mb-10">
                    <h3 class="text-xs font-bold text-[#8c7851] tracking-widest mb-4">SCHEDULE</h3>
                    ${day.items.map((item, idx) => `
                        <div class="schedule-card p-4 shadow-sm relative">
                            <button onclick="tripData.days[${tripData.currentDay}].items.splice(${idx},1);render();" class="absolute top-2 right-2 text-gray-300 text-xs">✕</button>
                            <div class="flex gap-4">
                                <input type="time" value="${item.time}" class="text-lg font-bold w-20 bg-transparent outline-none">
                                <div class="flex-1">
                                    <input type="text" value="${item.loc}" onchange="tripData.days[${tripData.currentDay}].items[${idx}].loc=this.value" class="font-bold block w-full outline-none text-base mb-1">
                                    <input type="text" value="${item.note}" onchange="tripData.days[${tripData.currentDay}].items[idx].note=this.value" class="text-xs text-gray-400 block w-full outline-none italic" placeholder="添加備註...">
                                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.loc)}" target="_blank" class="text-[10px] text-blue-400 mt-2 inline-block underline">VIEW ON MAP</a>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    <button onclick="addSchedule()" class="w-full py-3 border-2 border-dashed border-gray-200 rounded-xl text-gray-300 text-sm font-bold">+ ADD ACTIVITY</button>
                </div>

                <div class="bg-[#f3e9d2] rounded-2xl p-5 mb-10">
                    <h3 class="text-xs font-bold text-[#8c7851] mb-4">EXPENSES (${day.rate === 0.024 ? 'KRW' : 'JPY'})</h3>
                    <div class="space-y-3" id="expense-list">
                        ${day.expenses.map((ex, idx) => `
                            <div class="flex items-center gap-2">
                                <input type="text" value="${ex.name}" class="flex-1 bg-transparent border-b border-white/50 text-sm outline-none">
                                <input type="number" value="${ex.cost}" oninput="tripData.days[${tripData.currentDay}].expenses[${idx}].cost=this.value; updateTotal();" class="w-20 bg-transparent border-b border-white/50 text-right font-bold outline-none">
                                <span class="text-[10px] text-gray-400 w-12 text-right">≈ NT$ ${Math.round(ex.cost * day.rate)}</span>
                            </div>
                        `).join('')}
                    </div>
                    <button onclick="addExpense()" class="mt-4 text-[10px] font-bold text-[#8c7851] underline">+ ADD ITEM</button>
                    <div class="mt-6 pt-4 border-t border-white/30 text-right">
                        <span class="text-xs text-gray-500">TOTAL ESTIMATED</span>
                        <div class="text-2xl font-bold text-[#8c7851]" id="day-total">NT$ ${calculateDayTotal(day)}</div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function calculateDayTotal(day) {
            return Math.round(day.expenses.reduce((sum, ex) => sum + (Number(ex.cost) || 0), 0) * day.rate).toLocaleString();
        }

        function updateTotal() {
            const day = tripData.days[tripData.currentDay];
            document.getElementById('day-total').innerText = 'NT$ ' + calculateDayTotal(day);
            // 重新渲染局部以更新每行的單筆台幣 (優化版可只更新該行)
            render(); 
        }

        window.onload = () => switchDay(0);
    </script>
</body>
</html>
